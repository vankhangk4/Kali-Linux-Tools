1. chntpw là gì?

    chntpw (“Change NT Password”) là tool trên Linux, chuyên để:

        Reset password, enable/disable, unlock user account, cấp quyền admin cho user trên Windows mà không cần biết pass cũ.

        Chỉnh sửa SAM registry và đôi khi SYSTEM, SECURITY, SOFTWARE hive của Windows (file hệ thống registry).

    Hỗ trợ Windows NT, 2000, XP, Vista, 7, 8, 10, 11 (cả bản Server).

    Không cần boot được vào Windows! Chỉ cần mount ổ cứng Windows lên Linux là can thiệp được.

2. Cài đặt chntpw
A. Trên Kali/Ubuntu/Debian

sudo apt update
sudo apt install chntpw

(Fedora, Arch, RHEL cũng có trên repo)
3. Cách hoạt động – tổng quan

    Mỗi user Windows lưu hash pass (NTLM) trong file SAM:

    C:\Windows\System32\config\SAM

    chntpw sẽ reset (xoá hash) hoặc set lại quyền/enable/disable/unlock trực tiếp trên file này.

    Không crack pass, mà reset về rỗng (user có thể login không cần pass), hoặc đặt pass mới (hạn chế, nên dùng “blank” – trắng).

4. Thao tác thực tế
A. Mount ổ cứng Windows lên Linux

    Xác định phân vùng Windows (ví dụ /dev/sda2)

    Mount vào thư mục, ví dụ:

sudo mkdir /mnt/win
sudo mount /dev/sda2 /mnt/win

Vào thư mục chứa registry:

    cd /mnt/win/Windows/System32/config/

B. Liệt kê user Windows trong SAM

sudo chntpw -l SAM

    In ra danh sách tất cả user trên máy.

C. Reset password về trắng cho user (khuyên dùng)

sudo chntpw -u "tên_user" SAM

    Xuất hiện menu:

    - Clear (blank) user password
    - Unlock & enable user account
    - Promote user (add to administrators)
    - Quit editing user

    Chọn 1 để xoá pass (đặt thành rỗng).

    Sau đó chọn q (quit) rồi y (save).

D. Nâng quyền admin cho user bất kỳ

    Vẫn dùng lệnh trên, chọn Promote user (add to administrators) trong menu.

E. Mở khoá/Enable user bị disable

    Cũng trong menu, chọn Unlock & enable user account.

F. Reset toàn bộ user (automation)

sudo chntpw -i SAM

    Chế độ “interactive”, chọn user và thao tác menu như trên.

5. Fix lỗi phổ biến, note thực chiến
Vấn đề	Cách xử lý
Không mount được ổ	Kiểm tra phân vùng, tắt Fast Boot/Bitlocker/Encrypt
Báo “SAM in use”	Windows chưa tắt hoàn toàn, force shutdown rồi mount lại
Reset không hiệu lực	Có thể là Microsoft Account (không local user), pass lưu cloud, hoặc dùng Bitlocker
File bị Read-Only	Mount thêm với -o remount,rw hoặc ntfs-3g
Sau khi reset, login báo lỗi	Thử “Enable/Unlock user”, hoặc “Promote user”, hoặc check group policy
6. Chntpw nâng cao – script automation, edit registry, forensics
A. Chỉnh sửa registry key bất kỳ (not just SAM)

    Dùng mode Registry Editor:

    sudo chntpw -e SYSTEM

    Sử dụng các lệnh cd, ls, cat, ed, del, v.v. để edit registry.

B. Tạo script reset hàng loạt user

    Bash ví dụ:

    for u in $(sudo chntpw -l SAM | awk '/RID/ {print $2}'); do
      sudo chntpw -u "$u" SAM <<EOF

1
q
y
EOF
done
```

    Lọc list user, tự động blank pass tất cả.

C. Forensics:

    Dùng chntpw để xem history, group, policy của user mà không cần boot Win.

7. Một số lưu ý an toàn và rủi ro

    Reset password có thể gây lỗi với user dùng EFS (Encrypted File System), Bitlocker, hoặc account kết nối Microsoft Account.

    Luôn backup file SAM trước khi can thiệp:

    cp SAM SAM.bak

    Không được dùng chntpw cho mục đích bất hợp pháp!

    Reset xong, nên login local và đổi pass mới, tắt Remote Desktop hoặc đổi policy nếu máy dùng trong domain.

8. So sánh với tool khác
Tool	Ưu điểm	Nhược điểm
chntpw	Free, nhanh, trên Linux, không cần Windows boot	Không đặt pass mới trực tiếp, không crack hash
Offline NT Password & Registry Editor	Chạy boot ISO/USB	Giao diện text, thao tác y hệt chntpw
John the Ripper (samdump2)	Crack hash, forensics	Không reset pass, chỉ crack
Windows PE tool	Có GUI, boot USB	Dùng cho máy modern hơn
9. Tài liệu & link hữu ích

    chntpw Official

    chntpw GitHub

    Kali Docs – chntpw

    Reset Windows Password with chntpw – Hacktricks

Tóm tắt nhanh

    chntpw: tool cực mạnh để reset, mở khoá, cấp quyền user Windows chỉ bằng Linux, không cần biết pass cũ, không cần boot Win.

    Thích hợp cứu hộ quên mật khẩu, unlock admin, hoặc forensics, audit nội bộ.

    Dùng rất dễ, cực kỳ hiệu quả, miễn phí.

    Cẩn thận với tài khoản dùng mã hoá (EFS, Bitlocker, Microsoft Account)!